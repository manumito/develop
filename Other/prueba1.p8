pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
function _init()
	init_variables()
end

#include auxiliar.lua

function _update()
 if dead == false then
		move_player()
		move_enemy()
		detect_collision()
	end
end

function _draw()
 if dead == false then
 	cls(color_background) -- clear screen
	rect(1,1,127,127, color_background)
	load_map()	
	draw_player()
	draw_enemy()
	draw_flower()
	end
end

function move_player()
 	key_not_pressed = true
	if (btn(0)) then
		if can_move_sprite(directions.left, x, y, player.width) then
			player.x-=1
			player.sprite = 2
			key_not_pressed = false
		end
	end
	if (btn(1)) then 
		if can_move_sprite(directions.right, x, y, player.width) then
			player.x+=1
			player.sprite = 3
			key_not_pressed = false
		end
	end
	if (btn(2)) then
		if can_move_sprite(directions.up, x, y, player.width) then
			player.y-=1
			player.sprite = 4
			key_not_pressed = false
		end
	end
	if (btn(3)) then
		if can_move_sprite(directions.down, x, y, player.width) then
			player.y+=1
			player.sprite = 5
			key_not_pressed = false
		end
	end
	
	if (player.x == -sprite_size) then
		player.x = screen_size
	elseif (player.x == screen_size+sprite_size) then
		player.x = -sprite_size
	end

	if (player.y == -sprite_size) then
		player.y = screen_size
	elseif (player.y == screen_size+sprite_size) then
		player.y = -sprite_size
	end
		
	if (key_not_pressed) then
		player.sprite = 1
	end
end

function move_enemy()
	x = rnd(2)
	y = rnd(2)

 if give_oxigen then
		if (player.x < enemy.x) then
			enemy.x-=x
		elseif (player.x > enemy.x) then
			enemy.x+=x
		end
		
		if (player.y < enemy.y) then
			enemy.y-=y
		elseif (player.y > enemy.y) then
			enemy.y+=y
		end
	end
	
	if give_oxigen then
		give_oxigen = false
	else
	 give_oxigen = true
	end
	
end

function draw_player()
	spr(player.sprite, player.x, player.y)
	local x = tostr(player.x)..-tostr(player.y)
	local s = tostr(tmpx)..-tostr(tmpy)
	print(x, 90, 90, 11)
	print(x, 90, 110, 12)
end

function draw_enemy()
	--spr(enemy.sprite, enemy.x, enemy.y)
end

function detect_collision()
	if (abs(player.x-enemy.x)<=collision_size and abs(player.y-enemy.y)<collision_size) then
		--dead = true
	end
	if (dead) then
		cls(0)
		print ("has muerto pringao", 20, 20, 15)
	end	
end
__gfx__
000000000cccccc00cccccc00cccccc00c8cc8c00cccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000c8cc8c008cc8cc00cc8cc800cccccc00cccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007000cccccc00cccccc00cccccc00cc88cc00c8cc8c000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000cc88cc00c88ccc00ccc88c00cccccc00cccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000cc000000cc000000cc000000cc0000008800000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000cc00000ccc000000ccc00000cc000000cc00000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000e00e000e0e00000000e0e000e00e0000e00e0000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000e0000e0e000e000000e000e0e0000e00e0000e000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000a00000000000bbbbbbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000a900000000000b0b0b0bb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0009000000000000bb0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0005000000000000b0b0b0bb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0065600000000000bb0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0656560000000000b0b0b0bb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0065600000000000bb0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0006000000000000bbbbbbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
1212121212121212121212121212121200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1200000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1200000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1200000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1200000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1200000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1200000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1200000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1200000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1200000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1200000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1200000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1200000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1212121212121212121212121212121200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000203041e050260500f0500d05018050270502805000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
